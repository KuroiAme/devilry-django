{% extends "devilry_group/base.django.html" %}

{% load custom_filter %}

{% block header-text %}
    <h1>
        <h1>{{ assignment.long_name }}</h1><br><br>
        {{ subject.long_name }} {{ period.long_name }}
    </h1>
{% endblock header-text %}

{% block body %}
    <div class="col-sm-9 feedback_feed">
        {% block feed %}
            {% for timestamp, event in timeline.items %}
                {% if event.type == "comment" %}
                    {% with event.obj as comment %}
                        <div class="
                            {% if comment.user_role == "student" %}
                                student_comment
                            {% elif comment.user_role == "examiner"%}
                                examiner_comment
                            {% elif comment.user_role == "admin"%}
                                admin_comment
                            {% endif %}">
                            <div class="left_field">
                                <div class="comment-meta">
                                    <h1 class="comment_created_by">{{ comment.user }}</h1>
                                    <h1 class="comment_created_meta_text">({{ comment.user_role }}) - {{ comment.published_datetime }}</h1>
                                </div>
                                <div class="comment_text">
                                    {{ comment.text }}
                                </div>
                            </div>
                        </div>
                    {% endwith %}
                {% elif event.type == "deadline" %}
                    <p class="event_message">{{ timestamp }}:  {{ event.obj }}</p>
                {% elif event.type == "grade" %}
                    {% if event.obj >= assignment.passing_grade_min_points %}
                        <p class="event_message_passed">{{ timestamp }}: This delivery was corrected, and given the grade <strong>{{ event.obj }}/{{ assignment.max_points }} (passed)</strong></p>
                    {% else %}
                        <p class="event_message_failed">{{ timestamp }}: This delivery was corrected, and given the grade <strong>{{ event.obj }}/{{ assignment.max_points }} (failed)</strong></p>
                    {% endif %}
                {% endif %}
            {% endfor %}

{#            <div class="admin_comment">#}
{#                <div class="left_field">#}
{#                    <div class="comment-meta">#}
{#                        <h1 class="comment_created_by">Name</h1>#}
{#                        <h1 class="comment_created_meta_text">(admin) - 2 days ago (2015-05-17 09:01)</h1>#}
{#                    </div>#}
{#                    <div class="comment_text">#}
{#                        Lorem ipsum dolor sit amet, consectetur adipiscing elit.#}
{#                        Proin non nisl purus. Fusce elementum, odio id molestie elementum,#}
{#                        sem eros vehicula magna, vitae blandit purus lacus sed justo.#}
{#                        Etiam mattis tellus massa, nec vehicula nulla volutpat condimentum.#}
{#                        Sed eget odio sit amet erat vulputate porta. Donec vitae cursus nulla.#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{##}
{#            <p class="event_message">2015-05-17 12:10:  This delivery was corrected, and given the grade 5/30 (failed).</p>#}
{##}
{#            <div class="examiner_comment">#}
{#                <div class="left_field">#}
{#                    <div class="comment_meta">#}
{#                        <h1 class="comment_created_by">Name</h1>#}
{#                        <h1 class="comment_created_meta_text">(examiner) _ 2 days ago (2015-05-17 09:01)</h1>#}
{#                    </div>#}
{#                    <div class="comment_text">#}
{#                        Lorem ipsum dolor sit amet, consectetur adipiscing elit.#}
{#                        Proin non nisl purus. Fusce elementum, odio id molestie elementum,#}
{#                        sem eros vehicula magna, vitae blandit purus lacus sed justo.#}
{#                        Etiam mattis tellus massa, nec vehicula nulla volutpat condimentum.#}
{#                        Sed eget odio sit amet erat vulputate porta. Donec vitae cursus nulla.#}
{#                    </div>#}
{#                </div>#}
{#            </div>#}
{##}
{#            <p class="event_message_failed">2015_05_17 12:10:  This delivery was corrected, and given the grade 5/30 (failed).</p>#}
{##}
{#            <div class="student_comment">#}
{#                <div class="left_field">#}
{#                    <div class="comment_meta">#}
{#                        <h1 class="comment_created_by">Name</h1>#}
{#                        <h1 class="comment_created_meta_text">(student) _ 2 days ago (2015_05_17 09:01)</h1>#}
{#                    </div>#}
{#                    <div class="comment_text">#}
{#                        Lorem ipsum dolor sit amet, consectetur adipiscing elit.#}
{#                        Proin non nisl purus. Fusce elementum, odio id molestie elementum,#}
{#                        sem eros vehicula magna, vitae blandit purus lacus sed justo.#}
{#                        Etiam mattis tellus massa, nec vehicula nulla volutpat condimentum.#}
{#                        Sed eget odio sit amet erat vulputate porta. Donec vitae cursus nulla.#}
{#                    </div>#}
{#                    <div class="file_icon"></div>#}
{#                    <div class="file_icon"></div>#}
{#                    <div class="file_icon"></div>#}
{#                    <div class="image_icon"></div>#}
{#                </div>#}
{#                <div class="after_deadline_badge">#}
{#                    <p class="badge_text">NOT PART OF THE DELIVERY</p>#}
{#                </div>#}
{#            </div>#}
{##}
{#            <p class="event_message_passed">2015_05_17 12:10:  This delivery was corrected, and given the grade 5/30 (failed).</p>#}

        {% endblock feed %}
    </div>

    <div class="col-sm-3 feedback_sidebar">
        {% block sidebar %}
            <div class="top_headline">UPLOADED FILES</div>
            <br>
            <div class="sub_headline">FIRST DEADLINE</div>
            <div class="feedback_sidebar_files"><a href="#">{{ comment_text|devilry_truncatefileextension:13 }}</a></div>
            <br>
            <div class="sub_headline">SECOND DEADLINE</div>
            <a href="#"><div class="feedback_sidebar_files">{{ comment_text|devilry_truncatefileextension:13 }}</div></a>
            <a href="#"><div class="feedback_sidebar_files">{{ comment_text|devilry_truncatefileextension:13 }}</div></a>
            <br>

            <div class="top_headline">TEXT FORMATTING TOOLS</div>
            <div class="top_headline">CODE FORMATTING TOOLS</div>
            <div class="top_headline">MATH FORMATTING TOOLS</div>
        {% endblock sidebar %}
    </div>

{% endblock body %}
